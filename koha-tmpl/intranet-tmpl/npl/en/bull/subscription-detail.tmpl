<!-- TMPL_INCLUDE NAME="doc-head-open.inc" -->Koha -- Subscription Details for <!-- TMPL_VAR name="bibliotitle" --><!-- TMPL_INCLUDE NAME="doc-head-close.inc" -->
<!-- TMPL_INCLUDE NAME="masthead.inc" -->
<!-- TMPL_INCLUDE NAME="serials-topmenu.inc" -->
<!-- TMPL_INCLUDE NAME="intranet-nav.inc" -->

<script type="text/javascript" language="javascript">
<!--
// the english words used in display purposes
var text = new Array('Number','Volume','Issue','Month','Week','Starting with:','Rollover at:','Choose Hemisphere:','Northern','Southern',
'Autumn','Winter','Spring','Summer','Fall','Season','Year');

// common pre defined number patterns
function num_pattern() {
var patternchoice = '<!--TMPL_VAR NAME='numberpattern'-->';
	switch(patternchoice){
	case "2":
		options(text[1],text[0],text[2]);
		irregularity();
		display_table(0);
		break;
	case "3":
		options(text[1],text[0]);
		irregularity();
		display_table(0);
		break;
	case "4":
		options(text[1],text[2]);
		irregularity();
		display_table(0);
		break;
	case "5":
		options(text[0],text[2]);
		irregularity();
		display_table(0);
		break;
	case "6":
		var d = new Date();
		var sYear = d.getFullYear();
		// options_seasons(text[15],sYear);
		irregularity();
		is_season = 1;
		display_table(0);
		break;
	case "7":
		display_table(1);
		irregularity();
		break;
	case "8":
	        options(text[16],text[3]);
	        irregularity();
		is_month = 1;
		display_table(0);
		break;
	default:
		options(text[0]);
		irregularity();
		display_table(0);
		break;
	}
}

function display_table(n) {
	if(n==1){
		document.getElementById("basetable").style.display = 'block';
	} else {
		document.getElementById("basetable").style.display = 'none';
	}
}

// to dispaly the options section
function options(x,y,z){
var textbox = '';
	// alert("X: "+x+"Y: "+y+"Z: "+z);
	if(x){
		document.f.xfield.value = x;
		if(y){
			document.f.yfield.value = y;
			if(z){
				document.f.zfield.value = z;
			}
		}
	}
}

function irregularity(){
	var periodicity = '<!-- TMPL_VAR NAME="periodicity"-->';
	switch(periodicity){
	case "1":
		var names = new Array('Monday','Tuesday','Wednesday','Thursday','Friday','Saturday','Sunday');
		break;
	case "2":
		<!-- TMPL_IF NAME="weekarrayjs" -->
		var names = new Array(<!-- TMPL_VAR NAME="weekarrayjs" -->); 
		<!-- /TMPL_IF -->
		break;
	case "3":
		<!-- TMPL_IF NAME="weekarrayjs" -->
		var names = new Array(<!-- TMPL_VAR NAME="weekarrayjs" -->); 
		<!-- /TMPL_IF -->
		break;
	case "4":
		<!-- TMPL_IF NAME="weekarrayjs" -->
		var names = new Array(<!-- TMPL_VAR NAME="weekarrayjs" -->); 
		<!-- /TMPL_IF -->
		break;
	case "5":
		var names = new Array('January','February','March','April','May','June','July','August','September','October','November','December');
		break;
	case "6":
		var names = new Array('January','February','March','April','May','June','July','August','September','October','November','December');
		break;
	case "7":
		var names = new Array('January','February','March','April','May','June','July','August','September','October','November','December');
		break;
	case "8":
		var names = new Array('Autumn','Winter','Spring','Summer','Fall');
		break;
	case "9":
		var names = new Array('January','February','March','April','May','June','July','August','September','October','November','December');
		break;
	case "10":
		expected =1;
		break;
	default:
		break;
	}

	<!-- TMPL_IF NAME="irregularity" -->
	var irregular = '<!-- TMPL_VAR NAME="irregularity" -->';
	var irregarray = irregular.split('|');
	var irregtext = '<p>';
	for(var i=0;i<irregarray.length;i++){
		irregtext += names[i]+' &nbsp;';
	}
	irregtext += '</p>';
	document.getElementById("irreg").innerHTML = irregtext;
	<!-- /TMPL_IF -->
}

-->
</script>

<div id="main">
<h1>Subscription Details:  <!-- TMPL_VAR name="bibliotitle" --></h1>
<form class="inline" method="get" action="subscription-add.pl">
<input type="hidden" name="op" value="mod" />
<input type="hidden" name="subscriptionid" value="<!-- TMPL_VAR name="subscriptionid" -->" />
<input type="submit" class="submit" title="Modify subscription" value="Edit" /></form>

<form class="inline" method="get" action="statecollection.pl">
<input type="hidden" name="subscriptionid" value="<!-- TMPL_VAR name="subscriptionid" -->" />
<input type="submit" class="submit" value="Receive Issues" /></form>

<form class="inline" method="get" action="serial-issues.pl">
<input type="hidden" name="biblionumber" value="<!-- TMPL_VAR name="biblionumber" -->" />
<input type="submit" class="submit"  title="All issues on this title" value="Issue History" /></form>

<form class="inline" method="get" action="/cgi-bin/koha/bull-home.pl">
<input type="hidden" name="biblionumber" value="<!-- TMPL_VAR name="biblionumber" -->" />
<input type="submit" class="submit"  title="all subscriptions on <!-- TMPL_VAR name="bibliotitle" -->" value="Subscriptions" /></form>

<form class="inline" method="get" action="/cgi-bin/koha/MARCdetail.pl">
<input type="hidden" name="bib" value="<!-- TMPL_VAR name="biblionumber" -->" />
<input type="submit" class="submit"  title="go to <!-- TMPL_VAR name="bibliotitle" -->" value="View Biblio Record" /></form>

<form class="inline" method="get" action="/cgi-bin/koha/bull/routing.pl">
<input type="hidden" name="subscriptionid" value="<!-- TMPL_VAR name="subscriptionid" -->" />
<!-- TMPL_IF NAME="routing" -->
<input type="submit" class="submit" title="Edit Routing List" value="Edit Routing List" />
<!-- TMPL_ELSE -->
<input type="hidden" name="op" value="new" />
<input type="submit" class="submit" title="Create Routing List" value="Create Routing List" />
<!-- /TMPL_IF -->

<form class="inline"><input type="submit" class="cancel" value="Delete Subscription" onclick="confirm_deletion(); return false;" /></form>

<div class="data">
<table>	<caption>Subscription information</caption>
		<tr><th scope="row">Librarian identity:</td><td> <!-- TMPL_VAR name="librarian" --></td></tr>
		<tr><th scope="row">Supplier: </th><td><!-- TMPL_VAR name="aqbooksellername" --></td></tr>
		<tr><th scope="row">Cost:</th><td><!-- TMPL_VAR name="cost" --></td></tr>
		<tr><th scope="row">Budget:</th><td><!-- TMPL_VAR name="bookfundid" --></td></tr>
		<tr><th scope="row">Title:</th><td><a href="/cgi-bin/koha/MARCdetail.pl?bib=<!-- TMPL_VAR name="biblionumber" -->"><!-- TMPL_VAR name="bibliotitle" --></a></td></tr>
		<tr><th scope="row">Notes:</th><td><!-- TMPL_VAR name="notes" --></td></tr></table>
</div>

<div class="data">
<form name="f">
<table>	<caption>Planning</caption>
	<tr><th scope="row">Beginnning date:</th><td> <!-- TMPL_VAR name="startdate" --></td></tr>
	<tr><th scope="row">Frequency (*):</th><td>
		<!--TMPL_IF name="periodicity1" -->
				1/day
		<!-- /TMPL_IF -->
		<!--TMPL_IF name="periodicity2" -->
				1/week
		<!-- /TMPL_IF -->
		<!--TMPL_IF name="periodicity3" -->
				1/2 weeks
		<!-- /TMPL_IF -->
		<!--TMPL_IF name="periodicity4" -->
				1/3 weeks
		<!-- /TMPL_IF -->
		<!--TMPL_IF name="periodicity5" -->
				1/Month
		<!-- /TMPL_IF -->
		<!--TMPL_IF name="periodicity6" -->
				1/2 Months (6/year)
		<!-- /TMPL_IF -->
		<!--TMPL_IF name="periodicity7" -->
				1/Quarter
		<!-- /TMPL_IF -->
		<!--TMPL_IF name="periodicity8" -->
				1/Quarter
		<!-- /TMPL_IF -->
		<!--TMPL_IF name="periodicity9" -->
				2/Year
		<!-- /TMPL_IF -->
		<!--TMPL_IF name="periodicity10" -->
				1/Year
		<!-- /TMPL_IF -->
		<!--TMPL_IF name="periodicity11" -->
				1/2 Years
		<!-- /TMPL_IF -->
	</td></tr>
	
	<tr><th scope="row">Number Pattern:</th><td>
		<!-- TMPL_IF name="numberpattern1" -->
			Number
		<!-- /TMPL_IF -->
		<!-- TMPL_IF name="numberpattern2" -->
			Volume, Number, Issue
		<!-- /TMPL_IF -->
		<!-- TMPL_IF name="numberpattern3" -->
			Volume, Number
		<!-- /TMPL_IF -->
		<!-- TMPL_IF name="numberpattern4" -->
			Volume, Issue
		<!-- /TMPL_IF -->
		<!-- TMPL_IF name="numberpattern5" -->
			Number, Issue
		<!-- /TMPL_IF -->
		<!-- TMPL_IF name="numberpattern6" -->
			Seasonal only
		<!-- /TMPL_IF -->
		<!-- TMPL_IF name="numberpattern7" -->
			None of the above
		<!-- /TMPL_IF -->
	</td></tr>	
	
	<tr><th scope="row">Arrives on:</th><td>
		<!--TMPL_IF name="arrival1" -->
			Monday
		<!-- /TMPL_IF -->
		<!--TMPL_IF name="arrival2" -->
				Tuesday
		<!-- /TMPL_IF -->
		<!--TMPL_IF name="arrival3" -->
				Wednesday
		<!-- /TMPL_IF -->
		<!--TMPL_IF name="arrival4" -->
				Thursday
		<!-- /TMPL_IF -->
		<!--TMPL_IF name="arrival5" -->
				Friday
		<!-- /TMPL_IF -->
		<!--TMPL_IF name="arrival6" -->
				Saturday
		<!-- /TMPL_IF -->
		<!--TMPL_IF name="arrival7" -->
				Sunday
		<!-- /TMPL_IF --></table>
</div>


<table>
<tr><td>&nbsp;</td>
    <td align="right"><input type="text" name="xfield" style="border:0px solid #FFFFFF; text-align:center;"></td>
       <!--TMPL_IF NAME="lastvalue2"-->
           <td align="right"><input type="text" name="yfield" style="border:0px solid #FFFFFF; text-align:center;"></td>
       <!--/TMPL_IF-->
       <!--TMPL_IF NAME="lastvalue3"-->
           <td align="right"><input type="text" name="zfield" style="border:0px solid #FFFFFF; text-align:center;"></td>
       <!--/TMPL_IF-->
       </tr>
       <tr><td>Starting with:</td>
           <td align="center"><!--TMPL_VAR NAME="lastvalue1"--></td>
       <!--TMPL_IF NAME="lastvalue2"-->
           <td align="center">&nbsp;
                       <!--TMPL_VAR NAME="lastvalue2"-->
           </td>
       <!--/TMPL_IF-->
       <!--TMPL_IF NAME="lastvalue3"-->
           <td align="center">&nbsp;
                       <!--TMPL_VAR NAME="lastvalue3"-->
           </td>
       <!--/TMPL_IF-->
       </tr>
       <tr><td>Rollover:</td>
           <td align="center">&nbsp;</td>
       <!--TMPL_IF NAME="whenmorethan2"-->
           <td align="center">&nbsp;
                       <!--TMPL_VAR NAME="whenmorethan2"-->
           </td>
       <!--/TMPL_IF-->
       <!--TMPL_IF NAME="whenmorethan3"-->
           <td align="center">&nbsp;
                       <!--TMPL_VAR NAME="whenmorethan3"-->
           </td>
       <!--/TMPL_IF-->
       </tr>
       </table>
       <table>
       <!-- TMPL_IF NAME="irregularity" -->
       <tr><td>Irregularity:</td>
           <td><div id="irreg"></div></td></tr>
       <!-- /TMPL_IF -->
       <tr><td>Begins on:</td>
           <td><!--TMPL_VAR name="startdate" --></td>
       </tr>
       </table>
       </form>


<div class="data">
<table>	<caption>Subscription length</caption>
	<tr><th scope="row">Number of issues:</th><td><!-- TMPL_VAR name="numberlength" --></td></tr>
	<tr><th scope="row">Number of weeks:</th><td><!-- TMPL_VAR name="weeklength" --></td></tr>
	<tr><th scope="row">Number of months:</th><td><!-- TMPL_VAR name="monthlength" --></td></tr></table>

</div>
<div class="data" id="basetable">
	<h2>Numbering calculation</h2>
		
		<table><caption>Numbering formula: <!-- TMPL_VAR name="numberingmethod" --></caption>
			<tr>
				<th scope="row">&nbsp;</th>
				<th scope="col">X</th>
				<th scope="col">Y</th>
				<th scope="col">Z</th>
			</tr>
			<tr>
				<th scope="row">Add:</th>
				<td>
					<!-- TMPL_VAR name="add1" -->
				</td>
				<td>
					<!-- TMPL_VAR name="add2" -->
				</td>
				<td>
					<!-- TMPL_VAR name="add3" -->
				</td>
			</tr>
			<tr>
				<th scope="row">once every:</th>
				<td><!-- TMPL_VAR name="every1" --></td>
				<td><!-- TMPL_VAR name="every2" --></td>
				<td><!-- TMPL_VAR name="every3" --></td>
			</tr>
			<tr>
				<th scope="row">Starting period</th>
				<td><!-- TMPL_IF name="innerloop1" --><!-- TMPL_VAR name="innerloop1" --><!-- /TMPL_IF --></td>
				<td><!-- TMPL_IF name="innerloop2" --><!-- TMPL_VAR name="innerloop2" --><!-- /TMPL_IF --></td>
				<td><!-- TMPL_IF name="innerloop3" --><!-- TMPL_VAR name="innerloop3" --><!-- /TMPL_IF --></td>
			</tr>
			<tr>
				<th scope="row">When more than</th>
				<td><!-- TMPL_VAR name="whenmorethan1" --></td>
				<td><!-- TMPL_VAR name="whenmorethan2" --></td>
				<td><!-- TMPL_VAR name="whenmorethan3" --></td>
			</tr>
			<tr>
				<th scope="row">Set back to:</th>
				<td><!-- TMPL_VAR name="setto1" --></td>
				<td><!-- TMPL_VAR name="setto2" --></td>
				<td><!-- TMPL_VAR name="setto3" --></td>
			</tr>
			<tr>
				<th scope="row">
						Last value:
				</th>
				<td><!-- TMPL_VAR name="lastvalue1" --></td>
				<td><!-- TMPL_VAR name="lastvalue2" --></td>
				<td><!-- TMPL_VAR name="lastvalue3" --></td>
			</tr>
		</table>
</div>
<div class="data">
	<h2>Issues</h2>
	<table>
	<tr>
		<th scope="col">Issue number:</th>
		<th scope="col">Planned date:</th>
		<th scope="col">Status:</th>
		<th scope="col">Note:</th>
	</tr>
	<!-- TMPL_LOOP name="serialslist" -->
		<tr>
			<td>
				<!-- TMPL_VAR name="serialseq" -->
			</td>
			<td>
				<!-- TMPL_VAR name="planneddate" -->
			</td>
			<td>
					<!--TMPL_IF name="status1" -->
						Waited
					<!-- /TMPL_IF -->
					<!--TMPL_IF name="status2" -->
						Arrived
					<!-- /TMPL_IF -->
					<!--TMPL_IF name="status3" -->
						Late
					<!-- /TMPL_IF -->
					<!--TMPL_IF name="status4" -->
						Missing
					<!-- /TMPL_IF -->
			</td>
			<td>
				<!-- TMPL_VAR name="notes" -->
			</td>
		</tr>
	<!-- /TMPL_LOOP -->
	</table>
</div>
</div>
<script language="JavaScript" type="text/javascript">
function _(s) { return s } // dummy function for gettext
function confirm_deletion() {
	<!-- TMPL_IF name="totalissues" -->
		var is_confirmed = confirm(_('You already made <!-- TMPL_VAR name="totalissues"--> receipts. Do you confirm deletion?'));
	<!-- TMPL_ELSE -->
		var is_confirmed = confirm(_('Are you sure you want to delete this subscription?'));
	<!-- /TMPL_IF -->	
	if (is_confirmed) {
		window.location="subscription-detail.pl?subscriptionid=<!-- TMPL_VAR name="subscriptionid" -->&op=del";
	}
}
window.onload = num_pattern();
</script>
<!-- TMPL_INCLUDE NAME="intranet-bottom.inc" -->
